# 原网页版系统 API

该文档是基于对原网页版系统的分析编写而成，可能存在错误或随着原系统的更新而过时。

**全局约定**

- 基础地址：`http://139.155.71.163:1000/training/hs.php`
- 默认请求头：
  ```
  Accept: */*
  Accept-Encoding: gzip, deflate
  Accept-Language: en-US,en;q=0.9,zh-CN;q=0.8,zh;q=0.7
  Connection: keep-alive
  Content-type: application/x-www-form-urlencoded; charset=UTF-8
  Host: 139.155.71.163:1000
  Origin: http://139.155.71.163:1000
  Referer: http://139.155.71.163:1000/training/hs.php
  User-agent: <一个随机的浏览器User-agent>
  X-Requested-With: XMLHttpRequest
  ```
- 请求体格式：表单
- 响应体格式：JSON
- 成功响应示例（code 为 1）：
  ```json
  { "code": 1, "error": "成功" }
  ```
- 错误响应示例（code 为 0）：
  ```json
  { "code": 0, "error": "没有查询到订单信息，请联系客服人员！" }
  ```

## 查询订单数据

通过订单号查询订单数据。

### 请求

#### 方法与路径

`POST /`

#### 参数

| 字段名 | 说明   |
| ------ | ------ |
| key    | 订单号 |

### 响应

#### 成功示例

```json
{
  "code": 1,
  "error": "成功",
  "count": 1,
  "data": [
    {
      "am": "",
      "oid": "2025010100013333123456",
      "edate": "2025-12-18 20:05:30",
      "config": "{\"auto\":\"0\",\"battleheroes\":\"2047\",\"battlemode\":\"5\",\"region\":\"CN\"}",
      "details": "08:00-16:00  (2025/11/13 08:12:55)",
      "finish": "0",
      "banned": "0",
      "dltype": "5",
      "num1": "13040",
      "num2": "1",
      "num3": "44",
      "num7": "0",
      "num8": "428301",
      "dldata": "[8560,9,50,\"20251113\",4,0,0,\"CHN\",1762992775,0,[[1760757187,50,0],[1760749688,50,0],[1760678509,50,0],[1760672282,50,0],[1760667197,50,0],[1760338357,50,0],[1760336396,100,0],[1760330976,50,0],[1760321665,50,0],[1760320634,50,0],[1760078395,50,0],[1760059795,50,0],[1759992190,50,0],[1759975670,50,0],[1759972625,50,0],[1759898700,50,0],[1759890783,0,2],[1759887285,100,2],[1759885254,50,1],[1759807270,50,0],[1759800012,50,0],[1759729457,50,0],[1759721607,100,0],[1759713577,50,0],[1759645230,50,0],[1759628708,50,0],[1759550333,50,0],[1759540526,50,0],[1759478516,50,0],[1759464695,50,0],[1759454232,50,0],[1759390414,50,0],[1759374954,50,0],[1759369468,50,0],[1759296567,50,0],[1759288135,50,0],[1759219659,50,0],[1759203982,50,0],[1759196508,50,0],[1759126464,50,0],[1759117682,50,0],[1759116911,50,0],[1759114135,50,0],[1759110606,100,0],[1759108892,50,0],[1759045850,50,0],[1759033149,50,0],[1759022188,50,0],[1758956221,50,0],[1758943062,50,0]],[[1763008014,161,44,32962,862],[1763006162,1164,44,32801,701],[1763004684,123,43,31637,1037],[1763003279,78,43,31514,914],[1762933663,156,43,31327,727],[1762931963,43,43,31171,571],[1762930853,8,43,31128,528],[1762929887,77,43,31120,520],[1762928804,14,43,31043,443],[1762925656,154,43,31029,429],[1762923972,69,43,30875,275],[1762922840,78,43,30806,206],[1762921583,35,43,30728,128],[1762920243,139,43,30693,93],[1762918710,127,42,30554,1454],[1762917298,112,42,30427,1327],[1762916031,59,42,30315,1215],[1762915076,71,42,30256,1156],[1762912588,139,42,30154,1054],[1762911027,72,42,30015,915],[1762909889,76,42,29943,843],[1762908661,10,42,29867,767],[1762907762,53,42,29857,757],[1762847182,62,42,29721,621],[1762845849,55,42,29659,559],[1762844824,51,42,29604,504],[1762843826,59,42,29553,453],[1762842697,128,42,29494,394],[1762841248,113,42,29366,266],[1762839944,69,42,29253,153],[1762838792,90,42,29184,84],[1762837295,141,41,29094,1444],[1762835705,55,41,28953,1303],[1762834629,68,41,28898,1248],[1762833472,95,41,28830,1180],[1762831885,67,41,28735,1085],[1762830786,77,41,28668,1018],[1762829584,67,41,28591,941],[1762828482,124,41,28524,874],[1762827084,127,41,28400,750],[1762825614,68,41,28273,623],[1762824476,131,41,28205,555],[1762823038,78,41,28074,424],[1762821772,1126,41,27996,346],[1762761498,23,40,26589,389],[1762761096,57,40,26566,366],[1762760502,55,40,26509,309],[1762759764,54,40,26454,254],[1762758397,72,40,26400,200],[1762757539,34,40,26328,128]],[[0,0,0,1763008031],[1763007887,-1,161,1763006279],[1763006052,-1,1164,1763004695],[1763004601,-1,123,1763003319],[1763003207,-1,78,1763002092],[0,0,0,1763001300],[0,0,0,1762933702],[1762933592,-1,156,1762931980],[1762931912,-1,43,1762930930],[1762930798,-1,8,1762929953],[1762929834,-1,77,1762928832],[1762928742,-1,14,1762927893],[0,0,0,1762925746],[1762925584,-1,154,1762924010],[1762923915,-1,69,1762922857],[1762922772,-1,78,1762921632],[0,0,0,1762920279],[1762920153,-1,139,1762918735],[1762918641,-1,127,1762917371],[1762917226,-1,112,1762916055],[1762915982,-1,59,1762915099],[1762915014,-1,71,1762913826],[0,0,0,1762912610],[1762912489,-1,139,1762911045],[1762910961,-1,72,1762909899],[1762909835,-1,76,1762908744],[0,0,0,1762907816],[1762907664,-1,53,1762906878],[0,0,0,1762847214],[1762847061,-1,62,1762846037],[1762845917,0,0,1762845910],[1762845726,-1,55,1762844842],[1762844717,-1,51,1762843867],[1762843703,-1,59,1762842729],[1762842552,-1,128,1762841280],[1762841122,-1,113,1762839966],[1762839848,-1,69,1762838819],[1762838656,-1,90,1762837356],[1762837184,-1,141,1762835744],[1762835583,-1,55,1762834676],[1762834546,-1,68,1762833522],[1762833371,-1,95,1762831903],[1762831804,-1,67,1762830824],[1762830700,-1,77,1762829601],[1762829504,-1,67,1762828516],[1762828404,-1,124,1762827103],[1762827013,-1,127,1762825663],[1762825560,-1,68,1762824525],[1762824412,-1,131,1762823061],[1762822983,-1,78,1762821795]],[\"9170774525\",\"9169980593\",\"9169803641\",\"9168985355\",\"9169016515\",\"9168961005\",\"9168889106\",\"9168840042\",\"9167869149\",\"9167155425\",\"9167012312\"],0,0]",
      "remark": "2025/11/13_12:27:15_开始酒馆对战"
    }
  ]
}
```

#### 字段含义

##### 最外层

| 字段名 | 类型  | 说明     | 备注                                     |
| ------ | ----- | -------- | ---------------------------------------- |
| count  | int   | 含义未知 | 目前固定为 1                             |
| data   | array | 数据     | 目前长度固定为 1，包含多种数据，详见下文 |

##### data 字段

| 字段名  | 类型   | 说明         | 备注                                                                                      |
| ------- | ------ | ------------ | ----------------------------------------------------------------------------------------- |
| am      | string | 含义未知     | 目前固定为空字符串，在原网页上作为 HTML 代码被拼接在网页内容区域代码的最前面              |
| oid     | string | 订单编号     | 也可以用于查询。注意这和订单号（请求参数 key）是不同的，订单操作的 oid 参数必须传订单编号 |
| edate   | string | 到期时间     | 订单结束时间                                                                              |
| details | string | 上号时间     | 每日上号时间段和最近一次上号时间                                                          |
| finish  | string | 订单完成状态 | "1"：已完成，其它：未完成                                                                 |
| banned  | string | 订单封禁状态 | "0"：根据 finish 字段进一步确定订单状态，"1"：订单已终止                                  |
| dltype  | string | 含义未知     | 目前固定为"5"，没有在原网页系统上被使用                                                   |
| num1    | string | 金币数量     | 整数字符串                                                                                |
| num2    | string | 卡包数量     | 整数字符串                                                                                |
| num3    | string | 奖励等级     | 整数字符串；即通行证的等级，显示的时候要 +1                                               |
| num7    | string | 含义未知     | 目前固定为"0"，没有在原网页系统上被使用                                                   |
| num8    | string | 含义未知     | 整数字符串；目前观察到该值随着时间推移会变大                                              |
| remark  | string | 备注         | 备注信息                                                                                  |
| config  | string | 配置         | 配置信息，JSON 字符串格式（解析后为对象），详见下文                                       |
| dldata  | string | 详情         | 包含大量杂七杂八的数据，JSON 字符串格式（解析后为数组），详见下文                         |

##### config 字段

该 JSON 字符串解析后为对象，包含以下字段：

**auto**

- 类型：string
- 说明：是否自动领取奖励。如果该字段不存在，默认值为`"0"`。

| 值  | 含义 |
| --- | ---- |
| "0" | 否   |
| "1" | 是   |

**battleheroes**

- 类型：string
- 说明：当前对战英雄。如果该字段不存在，默认无限制（即全部英雄皆可用）。
- 计算方法：
  - 字段值为按位掩码的十进制字符串。每个比特位自低位到高位依次对应：战士、萨满祭司、潜行者、圣骑士、猎人、德鲁伊、术士、法师、牧师、恶魔猎手、死亡骑士。
  - 允许的职业其对应位设为 1，其余位设为 0。将该二进制数转为十进制数，再转为字符串。
  - 示例：
    - 仅“法师”与“术士”可用：`2^7 + 2^6 = 192`，字段值为`"192"`。
    - 仅“恶魔猎手”可用：`2^9 = 512`，字段值为`"512"`。
    - 全部职业可用：`2^11 - 1 = 2047`，字段值为`"2047"`（与字段缺省等价）。
    - 无任何职业可用：`"0"`。

**battlemode**

- 类型：string
- 说明：当前对战模式。如果该字段不存在，默认值为`"1"`。

| 值  | 含义     |
| --- | -------- |
| "1" | 休闲模式 |
| "2" | 标准模式 |
| "3" | 狂野模式 |
| "4" | 幻变模式 |
| "5" | 酒馆战棋 |

**region**

- 类型：string
- 说明：猜测是账号所在的服务器区域。该字段未在原网页系统上被使用。

**pause**

- 类型：string
- 说明：是否暂定上号。如果该字段不存在，默认值为`"0"`。

| 值  | 含义 |
| --- | ---- |
| "0" | 否   |
| "1" | 是   |

##### dldata 字段

该 JSON 字符串解析后为数组，目前长度固定为 16。以下是各个下标上的值的含义：

**0**

- 类型：int
- 说明：含义未知，目前值总是 8560。该字段未在原网页系统上被使用。

**1**

- 类型：int
- 说明：含义未知，目前值总是 9。该字段未在原网页系统上被使用。

**2**

- 类型：int
- 说明：含义未知，目前值总是 50。该字段未在原网页系统上被使用。

**3**

- 类型：string
- 说明：猜测为最近一次的上号日期，格式为`YYYYMMDD`。如果当前日期不等于该日期，“今日对战数”为 0，否则按后文提到的方式计算。

**4**

- 类型：int
- 说明：猜测是今日对战中获胜的次数。

**5**

- 类型：int
- 说明：猜测是今日对战中失败的次数。该值与下标 4 的值相加后在原网页系统上显示为“今日对战数”。

**6**

- 类型：int
- 说明：含义未知，目前值总是 0。该字段未在原网页系统上被使用。

**7**

- 类型：string
- 说明：猜测是账号所在的服务器区域。该字段未在原网页系统上被使用。

**8**

- 类型：int
- 说明：最近一次上号时间的秒级时间戳。该字段未在原网页系统上被使用。

**9**

- 类型：int
- 说明：含义未知，目前值总是 0。该字段未在原网页系统上被使用。

**10**

- 类型：array
- 说明：金币记录（实际上也包含卡包记录）。数组中每个元素为一个数组，包含 3 个元素：

| 下标 | 含义           | 备注                                                 |
| ---- | -------------- | ---------------------------------------------------- |
| 0    | 时间           | 时间戳（秒级）                                       |
| 1    | 金币（变化量） | 大于等于 0 的整数；如果大于 0，显示的时候在前面加"+" |
| 2    | 卡包（变化量） | 大于等于 0 的整数；如果大于 0，显示的时候在前面加"+" |

**11**

- 类型：array
- 说明：经验记录。数组中每个元素为一个数组，包含 5 个元素：

| 下标 | 含义           | 备注                                                                     |
| ---- | -------------- | ------------------------------------------------------------------------ |
| 0    | 时间           | 时间戳（秒级）                                                           |
| 1    | 经验（变化量） | 大于等于 0 的整数；如果大于 0，显示的时候在前面加"+"                     |
| 2    | 等级           | 大于等于 0 的整数；显示的时候要 +1                                       |
| 3    | 总经验         | 含义为猜测；该项未在原网页系统上被使用                                   |
| 4    | 当前等级经验   | 大于等于 0 的整数；当前通行证等级的经验值（目前通行证每级经验值为 1500） |

**12**

- 类型：array
- 说明：对战记录。数组中每个元素为一个数组，包含 4 个元素：

| 下标 | 含义           | 备注                                                                                                      |
| ---- | -------------- | --------------------------------------------------------------------------------------------------------- |
| 0    | 对局结束时间   | 时间戳（秒级）；含义为猜测；该项未在原网页系统上被使用                                                    |
| 1    | 对战结果       | 整数；0 表示未知，1 表示胜利，-1 表示失败；含义是结合微信小程序查战绩猜测得出；该项未在原网页系统上被使用 |
| 2    | 经验（变化量） | 大于等于 0 的整数；如果大于 0，显示的时候在前面加"+"                                                      |
| 3    | 对局开始时间   | 时间戳（秒级）；网页上显示为“时间”                                                                        |

**13**

- 类型：array
- 说明：一个包含一些整数字符串的数组，含义未知。该字段未在原网页系统上被使用。

**14**

- 类型：int
- 说明：含义未知，目前值总是 0。该字段未在原网页系统上被使用。

**15**

- 类型：int
- 说明：含义未知，目前值总是 0。该字段未在原网页系统上被使用。

## 设置对战模式

切换到指定对战模式。

### 请求

#### 方法与路径

`POST /`

#### 参数

| 字段名     | 说明                                                                         |
| ---------- | ---------------------------------------------------------------------------- |
| battlemode | 对战模式（参考[查询订单数据](#查询订单数据)响应的 config 字段的 battlemode） |
| oid        | 订单编号                                                                     |
| bnetpwd    | 战网密码前 4 位                                                              |

### 响应

#### 成功示例

```json
{ "code": 1, "error": "成功" }
```

## 设置对战英雄

设置一位或多位对战英雄。

### 请求

#### 方法与路径

`POST /`

#### 参数

| 字段名       | 说明                                                                           |
| ------------ | ------------------------------------------------------------------------------ |
| battleheroes | 英雄掩码（参考[查询订单数据](#查询订单数据)响应的 config 字段的 battleheroes） |
| oid          | 订单编号                                                                       |
| bnetpwd      | 战网密码前 4 位                                                                |

### 响应

#### 成功示例

```json
{ "code": 1, "error": "成功" }
```

## 设置是否自动领取奖励

开启或关闭自动领取奖励。

### 请求

#### 方法与路径

`POST /`

#### 参数

| 字段名  | 说明                                                                           |
| ------- | ------------------------------------------------------------------------------ |
| auto    | 是否自动领取奖励（参考[查询订单数据](#查询订单数据)响应的 config 字段的 auto） |
| oid     | 订单编号                                                                       |
| bnetpwd | 战网密码前 4 位                                                                |

### 响应

#### 成功示例

```json
{ "code": 1, "error": "成功" }
```
